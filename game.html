<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ•°å­—é€»è¾‘è§£å¯†</title>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #f4f4f4; padding: 20px; }
        
        /* ç¬”è®°æ¡†è®¾è®¡ */
        .filter-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .filter-box {
            flex: 1;
            max-width: 200px;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        .box-out { background-color: #ffebee; border-color: #d9534f; }
        .box-maybe { background-color: #fff9c4; border-color: #fbc02d; }
        .box-in { background-color: #e8f5e9; border-color: #4caf50; }
        
        .filter-title { font-size: 0.8em; font-weight: bold; display: block; margin-bottom: 5px; }
        .note-input { width: 90%; padding: 5px; border: 1px solid #ccc; border-radius: 4px; text-align: center; font-size: 1.1em; }

        .hint-text { 
            color: #d9534f; font-weight: bold; font-size: 1.1em; margin: 10px auto; 
            max-width: 600px; min-height: 40px; border: 2px solid #3498db; 
            padding: 10px; border-radius: 8px; background: white;
        }

        #history { 
            margin-top: 20px; border-top: 2px solid #333; padding-top: 10px; 
            text-align: left; display: inline-block; width: 100%; max-width: 600px;
        }

        #ss { color: #888; font-size: 0.8em; }
        input#ar { padding: 10px; font-size: 16px; width: 150px; border: 2px solid #3498db; border-radius: 5px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #5cb85c; color: white; border: none; border-radius: 5px; font-weight: bold; margin: 5px; }
        .reset-btn { background-color: #3498db; }

        .attempt-row { 
            margin: 5px 0; padding: 10px; border-radius: 5px; background-color: white; 
            border: 1px solid #ddd; font-size: 1em; color: #0056b3; 
            display: block;
        }
        
        .row-red { border-left: 15px solid #ff0000; background-color: #fff0f0; font-weight: bold; }
        .row-yellow { border-left: 15px solid #ffcc00; background-color: #fffdf0; }
        .row-normal { border-left: 5px solid #ddd; }

        .label-red { color: #ff0000; font-weight: bold; }
        .label-yellow { color: #b8860b; font-weight: bold; }

        strong { color: #2c3e50; font-size: 1.1em; }
    </style>
</head>
<body>
    <div style="text-align: left; margin-bottom: 10px;">
        <a href="index.html" style="text-decoration: none; color: blue; font-weight: bold;">â¬… è¿”å›è¯´æ˜é¡µ</a>
    </div>
    <h1>å¼€å§‹æ¸¸æˆ</h1>
    <h2>è¾“å…¥çš„æ•°å­—ä¸èƒ½é‡å¤ï¼Œä¸”ä¸èƒ½åŒ…å« 0ã€‚</h2>

    <div class="filter-container">
        <div class="filter-box box-out">
            <span class="filter-title">â›” 100% æ’é™¤ (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="...">
        </div>
        <div class="filter-box box-maybe">
            <span class="filter-title">â“ ä¸ç¡®å®š (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="...">
        </div>
        <div class="filter-box box-in">
            <span class="filter-title">âœ… 100% å­˜åœ¨ (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="...">
        </div>
    </div>

    <p id="ss"></p> 
    <p id="h" class="hint-text"></p>
    <input id="ar" type="text" maxlength="4" placeholder="è¾“å…¥4ä½æ•°å­—" onkeypress="if(event.key === 'Enter') checkGuess()">
    <button onclick="checkGuess()">æ£€æŸ¥</button>
    <button class="reset-btn" onclick="resetGame()">é‡æ–°å¼€å§‹</button>
    
    <div id="history"></div>

    <script>
    let firstNumber = null;
    let firstpm = null;
    let targetArray = [];
    
    function generateTarget() {
        targetArray = [];
        while (targetArray.length < 4) {
            let r = Math.floor(Math.random() * 9) + 1; 
            if (!targetArray.includes(r)) targetArray.push(r);
        }
    }

    function resetGame() {
        generateTarget();
        firstNumber = null;
        firstpm = null;
        document.getElementById("history").innerHTML = "";
        document.getElementById("h").innerHTML = "";
        document.getElementById("ar").value = "";
        let inputs = document.getElementsByClassName("note-input");
        for(let i=0; i<inputs.length; i++) inputs[i].value = "";
        alert("æ¸¸æˆå·²é‡ç½®ï¼");
    }

    generateTarget();

    function checkGuess() {
        let inputField = document.getElementById("ar");
        let userInput = inputField.value;
        let historyDiv = document.getElementById("history");

        if (userInput.length !== 4 || new Set(userInput).size !== 4 || userInput.includes("0")) {
            alert("è¯·è¾“å…¥4ä¸ªä¸é‡å¤çš„æ•°å­— (1-9)ï¼");
            return;
        }

        let userArray = Array.from(userInput, Number);
        let position = 0; let mark = 0;
        for (let i = 0; i < 4; i++) {
            if (userArray[i] === targetArray[i]) position++;
            else if (targetArray.includes(userArray[i])) mark++;
        }

        let currentTotalPm = position + mark;
        let hintMsg = "";

        if (firstNumber === null) {
            firstNumber = userInput;
            firstpm = currentTotalPm;
            hintMsg = "ç¬¬ä¸€æ¬¡å°è¯•å·²è®°å½•ã€‚ç¬¬äºŒæ¬¡çŒœæµ‹åå°†æä¾›æç¤º...";
        } else {
            let secondNumber = userInput;
            let secondpm = currentTotalPm;
            let m = 0;
            for (let i = 0; i < 4; i++) {
                if (firstNumber.includes(secondNumber[i])) m++;
            }

            let totalPm = firstpm + secondpm;
            switch (true) {
                case (m == 0 && firstpm == 2 && secondpm == 2): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && totalPm == 3): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 1 && firstpm == 1 && secondpm == 3): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 1 && firstpm == 3 && secondpm == 1): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 0): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªä¸ä¸Šæ¬¡é‡å¤çš„é‚£ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 0 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯ç¡®å®šçš„ï¼Œå¦æœ‰ä¸¤ä¸ªå¯èƒ½åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 3 && firstpm == 1): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªåœ¨ä¸Šæ¬¡å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 1 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && firstpm == 1 && secondpm == 1): hintMsg = "æç¤ºï¼šå°šæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¸­ï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªï¼ˆå¯èƒ½æ˜¯ä¸‰ä¸ªï¼‰ç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 3 && secondpm == 2 && firstpm == 1): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”è¿˜æœ‰ä¸€ä¸ªæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¹Ÿåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 3 && secondpm == 1 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”è¿˜æœ‰ä¸€ä¸ªæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¹Ÿåœ¨å¯†ç ä¸­ã€‚"; break;
                case (secondpm == 4): hintMsg = "ä½ æ‰¾åˆ°äº†æ‰€æœ‰æ•°å­—ï¼ç°åœ¨è¯·æŠŠå®ƒä»¬æ’åˆ°æ­£ç¡®çš„ä½ç½®ã€‚"; break;
                case (m == 3 && secondpm == 2 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœªä½¿ç”¨è¿‡çš„æ•°å­—ä¸­ä¹Ÿæœ‰ä¸€ä¸ªæ­£ç¡®çš„ã€‚"; break;
                case (m == 3 && secondpm == 3 && firstpm == 2): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”æœªä½¿ç”¨è¿‡çš„æ•°å­—ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && secondpm == 3 && firstpm == 1): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && secondpm == 1 && firstpm == 3): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 1): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 2 && secondpm == 1 && firstpm == 2): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 0 && totalPm == 3): hintMsg = "æç¤ºï¼šåœ¨ä¸¤æ¬¡å°è¯•ä¸­å‡æœªå‡ºç°çš„æ•°å­—é‡Œï¼Œæœ‰ä¸€ä¸ªæ˜¯ç¡®å®šçš„ï¼Œå¯èƒ½æœ‰ä¸¤ä¸ªåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 1 && secondpm == 2 && firstpm == 0): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªå‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”å½“å‰å°è¯•ä¸­ï¼ˆæœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„éƒ¨åˆ†æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 0 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªå‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”ä¸Šæ¬¡å°è¯•ä¸­ï¼ˆæœªåœ¨å½“å‰å‡ºç°ï¼‰çš„éƒ¨åˆ†æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 0 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœ‰ä¸€ä¸ªæœªä½¿ç”¨çš„æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 3 && firstpm == 0): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªåœ¨ä¸Šæ¬¡å‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœ‰ä¸€ä¸ªæœªä½¿ç”¨çš„æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 3 && secondpm == 1 && firstpm == 1): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªåŒ…å«çš„æ•°å­—ä¸­ï¼Œæœ‰ä¸¤ä¸ªï¼ˆå¯èƒ½ä¸‰ä¸ªï¼‰ç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                default: hintMsg = "æ­¤å¯¹æ¯”ç»„åˆæš‚æ— ç‰¹å®šæç¤ºã€‚è¯·æ‰‹åŠ¨å¯¹æ¯”ä½ çš„å°è¯•è®°å½•å¹¶ç»§ç»­çŒœæµ‹ã€‚"; 
            }
            document.getElementById("h").innerHTML = hintMsg;
            firstNumber = secondNumber; firstpm = secondpm;
        }

        let rows = historyDiv.getElementsByClassName('attempt-row');
        for (let i = 0; i < rows.length; i++) {
            rows[i].classList.remove('row-red', 'row-yellow');
            rows[i].classList.add('row-normal');
            let oldLabel = rows[i].getElementsByClassName('status-label')[0];
            if (oldLabel) oldLabel.remove();
        }

        let currentResult = `çŒœæµ‹: <strong>${userInput}</strong> | æ•°å­—å¯¹: ${currentTotalPm} | ä½ç½®å¯¹: ${position}`;
        let newRow = document.createElement('div');
        newRow.className = 'attempt-row row-red';
        newRow.innerHTML = `<span class="status-label label-red">[å½“å‰å°è¯•] </span>` + currentResult;
        
        if (rows.length > 0) {
            rows[0].classList.replace('row-normal', 'row-yellow');
            let yellowLabel = document.createElement('span');
            yellowLabel.className = 'status-label label-yellow';
            yellowLabel.innerText = '[ä¸Šæ¬¡å°è¯•] ';
            rows[0].prepend(yellowLabel);
        }

        if (position === 4) {
            newRow.innerHTML = `ğŸ‰ æ­å–œï¼æ­£ç¡®æ•°å­—æ˜¯ <strong>${userInput}</strong>ã€‚`;
            document.getElementById("h").innerHTML = "æ¸¸æˆé€šå…³ï¼";
        }

        historyDiv.insertBefore(newRow, historyDiv.firstChild);
        inputField.value = ""; 
    }
    </script>
</body>
</html>
