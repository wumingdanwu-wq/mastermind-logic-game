<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ•°å­—é€»è¾‘è§£å¯† - æ¸¸æˆè¿›è¡Œä¸­</title>
    <style>
        :root {
            --primary: #1e40af;
            --success: #16a34a;
            --danger: #dc2626;
            --warning: #ca8a04;
            --bg-page: #f3f4f6;
            --white: #ffffff;
        }

        * { box-sizing: border-box; }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-page); 
            text-align: center; 
            padding: 15px; 
            margin: 0;
            color: #374151;
            -webkit-text-size-adjust: 100%;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .header-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .back-link {
            text-decoration: none;
            color: var(--primary);
            font-weight: bold;
            font-size: 1rem;
            padding: 8px 12px;
            background: #e0e7ff;
            border-radius: 8px;
        }

        h1 { margin: 10px 0 5px 0; font-size: 1.8rem; color: #111827; }
        h2 { margin: 0 0 20px 0; font-size: 0.95rem; color: #6b7280; font-weight: normal; }

        /* ç¬”è®°/è‰ç¨¿åŒº (æ‰‹æœºç«¯ç«–å‘æ’åˆ—) */
        .filter-container {
            display: flex;
            flex-wrap: wrap; /* å…³é”®ï¼šå…è®¸æ¢è¡Œ */
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-box {
            flex: 1;
            min-width: 100%; /* æ‰‹æœºç«¯å æ»¡ä¸€è¡Œ */
            background: white;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #e5e7eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* å¹³æ¿ä»¥ä¸Šæ¢å¤å¹¶æ’ */
        @media (min-width: 600px) {
            .filter-box { min-width: auto; }
        }

        .box-out { border-color: #fecaca; background: #fef2f2; }
        .box-maybe { border-color: #fde68a; background: #fffbeb; }
        .box-in { border-color: #bbf7d0; background: #f0fdf4; }
        
        .filter-title { 
            font-size: 0.9rem; 
            font-weight: bold; 
            display: block; 
            margin-bottom: 8px; 
            color: #4b5563;
        }

        .note-input { 
            width: 100%; 
            padding: 8px; 
            border: 1px solid #d1d5db; 
            border-radius: 6px; 
            text-align: center; 
            font-size: 1.1rem; 
            background: rgba(255,255,255,0.8);
        }

        /* æç¤ºæ¡† */
        .hint-text { 
            color: var(--danger); 
            font-weight: bold; 
            font-size: 1rem; 
            margin: 15px auto; 
            width: 100%;
            max-width: 600px; 
            min-height: 40px; 
            border: 2px solid #bfdbfe; 
            padding: 12px; 
            border-radius: 12px; 
            background: white;
            line-height: 1.5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* æ¸¸æˆæ§åˆ¶åŒº (è¾“å…¥æ¡†+æŒ‰é’®) */
        .game-controls {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto 15px auto;
        }

        input#ar { 
            flex: 2; /* è¾“å…¥æ¡†å 2ä»½ */
            padding: 12px; 
            font-size: 1.2rem; 
            border: 2px solid var(--primary); 
            border-radius: 10px; 
            text-align: center;
            outline: none;
            -webkit-appearance: none; /* å»é™¤iOSé»˜è®¤åœ†è§’ */
        }
        
        input#ar:focus { border-color: var(--warning); box-shadow: 0 0 0 3px rgba(202, 138, 4, 0.2); }

        button { 
            font-size: 1.1rem; 
            cursor: pointer; 
            border: none; 
            border-radius: 10px; 
            font-weight: bold; 
            transition: transform 0.1s;
        }

        button:active { transform: scale(0.96); }

        .check-btn {
            flex: 1; /* æŒ‰é’®å 1ä»½ */
            background-color: var(--success); 
            color: white; 
            padding: 12px;
            box-shadow: 0 4px 6px rgba(22, 163, 74, 0.3);
        }

        .reset-btn { 
            width: 100%; 
            max-width: 600px;
            background-color: white; 
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 10px;
            margin-top: 5px;
        }

        /* å†å²è®°å½•åŒº */
        #history { 
            margin-top: 25px; 
            padding-top: 10px; 
            text-align: left; 
            display: block; 
            width: 100%; 
            max-width: 600px;
            margin-left: auto; 
            margin-right: auto;
        }

        .attempt-row { 
            margin: 8px 0; 
            padding: 15px; 
            border-radius: 12px; 
            background-color: white; 
            border: 1px solid #e5e7eb; 
            font-size: 1.1rem; 
            color: #374151; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .row-red { border-left: 10px solid var(--danger); background-color: #fff1f2; font-weight: bold; }
        .row-yellow { border-left: 10px solid var(--warning); background-color: #fffbeb; }
        .row-normal { border-left: 6px solid #d1d5db; }

        .status-tag {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 8px;
            text-transform: uppercase;
        }
        .tag-red { background: var(--danger); color: white; }
        .tag-yellow { background: var(--warning); color: white; }

        /* ç»“æœæ–‡å­—ä¼˜åŒ– */
        .result-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            font-size: 0.9rem;
            color: #6b7280;
        }
        .result-main {
            font-size: 1.1rem;
            color: #111827;
            font-weight: bold;
        }

        strong { color: #111827; font-weight: 800; font-size: 1.2em; }
    </style>
</head>
<body>
    <div class="header-nav">
        <a href="index.html" class="back-link">â¬… è¿”å›è¯´æ˜</a>
    </div>

    <h1>æ•°å­—é€»è¾‘è§£å¯†</h1>
    <h2>è§„åˆ™ï¼š4ä½ä¸é‡å¤æ•°å­— (æ— 0)</h2>

    <div class="filter-container">
        <div class="filter-box box-out">
            <span class="filter-title">â›” æ’é™¤ (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="è¾“å…¥æ’é™¤é¡¹...">
        </div>
        <div class="filter-box box-maybe">
            <span class="filter-title">â“ å­˜ç–‘ (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="è¾“å…¥å­˜ç–‘é¡¹...">
        </div>
        <div class="filter-box box-in">
            <span class="filter-title">âœ… ç¡®å®š (ç¬”è®°)</span>
            <input type="text" class="note-input" placeholder="è¾“å…¥ç¡®å®šé¡¹...">
        </div>
    </div>

    <p id="h" class="hint-text">å‡†å¤‡å¥½äº†å—ï¼Ÿåœ¨ä¸‹æ–¹è¾“å…¥ä½ çš„çŒœæµ‹...</p>
    
    <div class="game-controls">
        <input id="ar" type="number" pattern="[0-9]*" inputmode="numeric" maxlength="4" placeholder="è¾“å…¥4ä½æ•°å­—" onkeypress="if(event.key === 'Enter') checkGuess()">
        <button class="check-btn" onclick="checkGuess()">æ£€æŸ¥</button>
    </div>
    
    <button class="reset-btn" onclick="resetGame()">ğŸ”„ é‡æ–°å¼€å§‹æ¸¸æˆ</button>
    
    <div id="history"></div>

    <script>
    let firstNumber = null;
    let firstpm = null;
    let targetArray = [];
    
    function generateTarget() {
        targetArray = [];
        while (targetArray.length < 4) {
            let r = Math.floor(Math.random() * 9) + 1; 
            if (!targetArray.includes(r)) targetArray.push(r);
        }
        console.log("Cheater! Target is: " + targetArray.join("")); // è°ƒè¯•ç”¨
    }

    function resetGame() {
        generateTarget();
        firstNumber = null;
        firstpm = null;
        document.getElementById("history").innerHTML = "";
        document.getElementById("h").innerHTML = "æ¸¸æˆå·²é‡ç½®ï¼Œè¯·è¾“å…¥æ–°çš„çŒœæµ‹...";
        document.getElementById("ar").value = "";
        let inputs = document.getElementsByClassName("note-input");
        for(let i=0; i<inputs.length; i++) inputs[i].value = "";
    }

    generateTarget();

    function checkGuess() {
        let inputField = document.getElementById("ar");
        let userInput = inputField.value;
        let historyDiv = document.getElementById("history");

        if (userInput.length !== 4 || new Set(userInput).size !== 4 || userInput.includes("0")) {
            alert("âš ï¸ æ ¼å¼é”™è¯¯ï¼š\nè¯·è¾“å…¥ 4 ä¸ªä¸é‡å¤çš„æ•°å­— (1-9)");
            return;
        }

        let userArray = Array.from(userInput, Number);
        let position = 0; let mark = 0;
        for (let i = 0; i < 4; i++) {
            if (userArray[i] === targetArray[i]) position++;
            else if (targetArray.includes(userArray[i])) mark++;
        }

        let currentTotalPm = position + mark;
        let hintMsg = "";

        // é€»è¾‘æç¤ºæ ¸å¿ƒéƒ¨åˆ†ï¼ˆä¿æŒä¸å˜ï¼Œä»…ä¼˜åŒ–æ˜¾ç¤ºæ–‡å­—ï¼‰
        if (firstNumber === null) {
            firstNumber = userInput;
            firstpm = currentTotalPm;
            hintMsg = "è®°å½•æˆåŠŸï¼å†è¯•ä¸€æ¬¡ï¼Œæˆ‘å°†å¯¹æ¯”è¿™ä¸¤æ¬¡çŒœæµ‹ç»™ä½ æç¤º...";
        } else {
            let secondNumber = userInput;
            let secondpm = currentTotalPm;
            let m = 0;
            for (let i = 0; i < 4; i++) {
                if (firstNumber.includes(secondNumber[i])) m++;
            }

            let totalPm = firstpm + secondpm;
            // ä¿æŒåŸæœ‰çš„å¤æ‚é€»è¾‘åˆ¤æ–­ case ...
            switch (true) {
                case (m == 0 && firstpm == 2 && secondpm == 2): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && totalPm == 3): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 1 && firstpm == 1 && secondpm == 3): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 1 && firstpm == 3 && secondpm == 1): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 0): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªä¸ä¸Šæ¬¡é‡å¤çš„é‚£ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 0 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„æ•°å­—é‡Œï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯ç¡®å®šçš„ï¼Œå¦æœ‰ä¸¤ä¸ªå¯èƒ½åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 3 && firstpm == 1): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªåœ¨ä¸Šæ¬¡å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 1 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„ä¸¤ä¸ªæ•°å­—ï¼Œç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && firstpm == 1 && secondpm == 1): hintMsg = "æç¤ºï¼šå°šæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¸­ï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªï¼ˆå¯èƒ½æ˜¯ä¸‰ä¸ªï¼‰ç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 3 && secondpm == 2 && firstpm == 1): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”è¿˜æœ‰ä¸€ä¸ªæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¹Ÿåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 3 && secondpm == 1 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”è¿˜æœ‰ä¸€ä¸ªæœªæµ‹è¯•è¿‡çš„æ•°å­—ä¹Ÿåœ¨å¯†ç ä¸­ã€‚"; break;
                case (secondpm == 4): hintMsg = "ä½ æ‰¾åˆ°äº†æ‰€æœ‰æ•°å­—ï¼ç°åœ¨è¯·æŠŠå®ƒä»¬æ’åˆ°æ­£ç¡®çš„ä½ç½®ã€‚"; break;
                case (m == 3 && secondpm == 2 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨å½“å‰å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœªä½¿ç”¨è¿‡çš„æ•°å­—ä¸­ä¹Ÿæœ‰ä¸€ä¸ªæ­£ç¡®çš„ã€‚"; break;
                case (m == 3 && secondpm == 3 && firstpm == 2): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­ï¼ˆä¸”æœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„ä¸€ä¸ªæ•°å­—100%åœ¨å¯†ç ä¸­ï¼Œä¸”æœªä½¿ç”¨è¿‡çš„æ•°å­—ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && secondpm == 3 && firstpm == 1): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 0 && secondpm == 1 && firstpm == 3): hintMsg = "æç¤ºï¼šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æ•°å­—ï¼Œç»å¯¹ä¸åœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 2 && secondpm == 2 && firstpm == 1): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 2 && secondpm == 1 && firstpm == 2): hintMsg = "æç¤ºï¼šç¡®å®šè¿™ä¸¤æ¬¡å°è¯•ä¸­å‡æœªåŒ…å«çš„æŸäº›æ•°å­—æ˜¯å¯†ç çš„ä¸€éƒ¨åˆ†ã€‚"; break;
                case (m == 0 && totalPm == 3): hintMsg = "æç¤ºï¼šåœ¨ä¸¤æ¬¡å°è¯•ä¸­å‡æœªå‡ºç°çš„æ•°å­—é‡Œï¼Œæœ‰ä¸€ä¸ªæ˜¯ç¡®å®šçš„ï¼Œå¯èƒ½æœ‰ä¸¤ä¸ªåœ¨å¯†ç ä¸­ã€‚"; break;
                case (m == 1 && secondpm == 2 && firstpm == 0): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªå‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”å½“å‰å°è¯•ä¸­ï¼ˆæœªåœ¨ä¸Šæ¬¡å‡ºç°ï¼‰çš„éƒ¨åˆ†æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 0 && firstpm == 2): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªå‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”ä¸Šæ¬¡å°è¯•ä¸­ï¼ˆæœªåœ¨å½“å‰å‡ºç°ï¼‰çš„éƒ¨åˆ†æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 0 && firstpm == 3): hintMsg = "æç¤ºï¼šä¸Šæ¬¡å°è¯•ä¸­æœªåœ¨å½“å‰å‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœ‰ä¸€ä¸ªæœªä½¿ç”¨çš„æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 1 && secondpm == 3 && firstpm == 0): hintMsg = "æç¤ºï¼šå½“å‰å°è¯•ä¸­æœªåœ¨ä¸Šæ¬¡å‡ºç°çš„æ•°å­—ç»å¯¹åœ¨å¯†ç ä¸­ï¼Œä¸”æœ‰ä¸€ä¸ªæœªä½¿ç”¨çš„æ•°å­—ä¹Ÿåœ¨ã€‚"; break;
                case (m == 3 && secondpm == 1 && firstpm == 1): hintMsg = "æç¤ºï¼šä¸¤æ¬¡å°è¯•å‡æœªåŒ…å«çš„æ•°å­—ä¸­ï¼Œæœ‰ä¸¤ä¸ªï¼ˆå¯èƒ½ä¸‰ä¸ªï¼‰ç»å¯¹åœ¨å¯†ç ä¸­ã€‚"; break;
                default: hintMsg = "æ­¤å¯¹æ¯”ç»„åˆæš‚æ— ç‰¹å®šæç¤ºã€‚è¯·æ‰‹åŠ¨å¯¹æ¯”ä½ çš„å°è¯•è®°å½•å¹¶ç»§ç»­çŒœæµ‹ã€‚"; 
            }
            document.getElementById("h").innerHTML = hintMsg;
            firstNumber = secondNumber; firstpm = secondpm;
        }

        // æ¸…é™¤æ—§æ ·å¼
        let rows = historyDiv.getElementsByClassName('attempt-row');
        for (let i = 0; i < rows.length; i++) {
            rows[i].classList.remove('row-red', 'row-yellow');
            rows[i].classList.add('row-normal');
            // ç§»é™¤æ—§çš„æ ‡ç­¾
            let oldTag = rows[i].querySelector('.status-tag');
            if(oldTag) oldTag.remove();
        }

        // åˆ›å»ºæ–°è¡Œ
        let newRow = document.createElement('div');
        newRow.className = 'attempt-row row-red';
        
        let tagHtml = `<span class="status-tag tag-red">å½“å‰</span>`;
        
        // ä¸“é—¨ä¸ºæ‰‹æœºä¼˜åŒ–çš„HTMLç»“æ„
        newRow.innerHTML = `
            <div>
                ${tagHtml} <strong>${userInput}</strong>
            </div>
            <div class="result-info">
                <span class="result-main">æ•°å­—å¯¹:${currentTotalPm} | ä½ç½®å¯¹:${position}</span>
            </div>
        `;
        
        // æ ‡è®°ä¸Šä¸€è¡Œ
        if (rows.length > 0) {
            rows[0].classList.replace('row-normal', 'row-yellow');
            let prevContent = rows[0].innerHTML;
            // ç®€å•çš„æ’å…¥æ–¹å¼
            if(!rows[0].innerHTML.includes('status-tag')) {
                 rows[0].insertAdjacentHTML('afterbegin', `<span class="status-tag tag-yellow">ä¸Šæ¬¡</span>`);
            } else {
                 rows[0].querySelector('.status-tag').className = 'status-tag tag-yellow';
                 rows[0].querySelector('.status-tag').innerText = 'ä¸Šæ¬¡';
            }
        }

        if (position === 4) {
            newRow.innerHTML = `<div style="text-align:center; width:100%; color:#16a34a;">
                ğŸ‰ <strong>ä¸€é©¬è¸å¹³å·ï¼</strong><br>ç­”æ¡ˆå°±æ˜¯ ${userInput}
            </div>`;
            document.getElementById("h").innerHTML = "ğŸ‰ é©¬å¹´è¡Œå¤§è¿ï¼å¤§å‰ï¼";
            newRow.style.borderLeftColor = "#16a34a";
            newRow.style.background = "#dcfce7";
        }

        historyDiv.insertBefore(newRow, historyDiv.firstChild);
        inputField.value = ""; 
        inputField.focus(); // èšç„¦å›è¾“å…¥æ¡†
    }
    </script>
</body>
</html>
